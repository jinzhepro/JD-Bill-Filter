# äº¬ä¸œå•æ®å¤„ç†ç³»ç»Ÿ - JD Bill Filter

åŸºäº Next.js çš„äº¬ä¸œå¯¹å¸å•å¤„ç†ç³»ç»Ÿï¼Œæ”¯æŒ Excel/CSV æ–‡ä»¶å¯¼å…¥ã€æ™ºèƒ½è®¢å•åˆå¹¶ã€ç»“ç®—å•å¤„ç†å’Œä¾›åº”å•†è½¬æ¢ç­‰åŠŸèƒ½ã€‚

## ğŸ“‹ ç›®å½•

- [åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§)
- [æŠ€æœ¯æ ˆ](#-æŠ€æœ¯æ ˆ)
- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [é¡¹ç›®ç»“æ„](#-é¡¹ç›®ç»“æ„)
- [æ ¸å¿ƒåŠŸèƒ½](#-æ ¸å¿ƒåŠŸèƒ½)
- [å¼€å‘è§„èŒƒ](#-å¼€å‘è§„èŒƒ)
- [å®‰å…¨æ³¨æ„äº‹é¡¹](#-å®‰å…¨æ³¨æ„äº‹é¡¹)
- [è®¸å¯è¯](#-è®¸å¯è¯)
- [è´¡çŒ®](#-è´¡çŒ®)
- [è”ç³»æ–¹å¼](#-è”ç³»æ–¹å¼)
- [ç‰ˆæœ¬ä¿¡æ¯](#-ç‰ˆæœ¬ä¿¡æ¯)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ç»“ç®—å•å¤„ç†

- ğŸ“¤ æ‰¹é‡å¯¼å…¥ç»“ç®—å•æ–‡ä»¶ï¼ˆExcel/CSVï¼‰
- ğŸ”„ è‡ªåŠ¨åˆå¹¶ç›¸åŒ SKU çš„è´§æ¬¾å’Œæ•°é‡
- ğŸ§® æ™ºèƒ½å¤„ç†å”®åå–å®¶èµ”ä»˜è´¹ï¼ˆæŒ‰è´§æ¬¾æ¯”ä¾‹åˆ†æ‘Šï¼‰
- ğŸ“Š æ”¯æŒå¤šæ–‡ä»¶æ‰¹é‡å¤„ç†
- ğŸ“¥ å¯¼å‡ºåˆå¹¶åçš„ç»“ç®—å•
- âœï¸ æ‰‹åŠ¨è°ƒæ•´ç»“ç®—å•æ•°æ®ï¼ˆæ”¯æŒç›¸åŒ SKU åˆå¹¶è®¡ç®—ï¼‰

### ä¾›åº”å•†è½¬æ¢

- ğŸ¢ ä¾›åº”å•†ä¿¡æ¯ç®¡ç†
- ğŸ” æ ¹æ®åŒ¹é…å­—ç¬¦ä¸²è‡ªåŠ¨è¯†åˆ«ä¾›åº”å•†
- ğŸ“ è‡ªå®šä¹‰ä¾›åº”å•†åŒ¹é…è§„åˆ™
- ğŸ”„ æ‰¹é‡ä¾›åº”å•†ä¿¡æ¯è½¬æ¢

### æ•°æ®å±•ç¤º

- ğŸ“Š è¡¨æ ¼åŒ–å±•ç¤ºå¤„ç†ç»“æœ
- ğŸ¨ æ”¯æŒæ’åºå’Œå¤åˆ¶åˆ—æ•°æ®
- ğŸ“ˆ å®æ—¶ç»Ÿè®¡è´§æ¬¾ã€ç›´è¥æœåŠ¡è´¹ã€æ”¶å…¥ç­‰æŒ‡æ ‡
- ğŸ” æ•°æ®å˜åŒ–è¯¦æƒ…æŸ¥çœ‹

## ğŸš€ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Next.js 16.0.10 (App Router)
- **è¯­è¨€**: JavaScript (æ—  TypeScript)
- **UI åº“**: shadcn/ui + Tailwind CSS
- **çŠ¶æ€ç®¡ç†**: React Context + useReducer
- **æ•°å€¼è®¡ç®—**: Decimal.js (é«˜ç²¾åº¦æ•°å­¦)
- **æ–‡ä»¶å¤„ç†**: ExcelJS (Excel), åŸç”Ÿ API (CSV)
- **å›¾æ ‡**: Lucide React
- **æµ‹è¯•**: æ—  (æ¨èå®‰è£… Vitest + Testing Library)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 18+
- npm æˆ– yarn

### å®‰è£…ä¾èµ–

```bash
npm install
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® http://localhost:3000

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
npm start
```

### ä»£ç è´¨é‡æ£€æŸ¥

```bash
npm run lint
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
JD-Bill-Filter/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router é¡µé¢
â”‚   â”‚   â”œâ”€â”€ page.js            # é¦–é¡µï¼ˆç»“ç®—å•å¤„ç†ï¼‰
â”‚   â”‚   â”œâ”€â”€ suppliers/         # ä¾›åº”å•†è½¬æ¢é¡µé¢
â”‚   â”‚   â”œâ”€â”€ layout.js          # æ ¹å¸ƒå±€
â”‚   â”‚   â””â”€â”€ globals.css        # å…¨å±€æ ·å¼ï¼ˆshadcn/uiï¼‰
â”‚   â”œâ”€â”€ components/            # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ui/               # shadcn/ui åŸºç¡€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ button.js     # æŒ‰é’®ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ input.js      # è¾“å…¥æ¡†ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ table.js      # è¡¨æ ¼ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ toast.js      # Toast æç¤º
â”‚   â”‚   â”‚   â””â”€â”€ modal.js      # æ¨¡æ€æ¡†ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ SettlementContent.js        # ç»“ç®—å•å†…å®¹
â”‚   â”‚   â”œâ”€â”€ SettlementFolderUpload.js   # ç»“ç®—å•æ–‡ä»¶å¤¹ä¸Šä¼ 
â”‚   â”‚   â”œâ”€â”€ SettlementResultDisplay.js  # ç»“ç®—å•ç»“æœå±•ç¤º
â”‚   â”‚   â”œâ”€â”€ SettlementProcessForm.js    # ç»“ç®—å•æ‰‹åŠ¨å¤„ç†è¡¨å•
â”‚   â”‚   â”œâ”€â”€ Sidebar.js        # ä¾§è¾¹æ å¯¼èˆª
â”‚   â”‚   â”œâ”€â”€ SupplierManager.js # ä¾›åº”å•†ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ FileUploader.js   # æ–‡ä»¶ä¸Šä¼ 
â”‚   â”‚   â”œâ”€â”€ DataDisplay.js    # æ•°æ®å±•ç¤º
â”‚   â”‚   â”œâ”€â”€ SimpleLayout.js   # ç®€å•å¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ ErrorBoundary.js  # é”™è¯¯è¾¹ç•Œ
â”‚   â”‚   â””â”€â”€ ThemeToggle.js    # ä¸»é¢˜åˆ‡æ¢
â”‚   â”œâ”€â”€ context/              # React Context çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ AppContext.js     # å…¨å±€åº”ç”¨çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ SettlementContext.js # ç»“ç®—å•çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ SupplierContext.js # ä¾›åº”å•†çŠ¶æ€
â”‚   â”‚   â””â”€â”€ ThemeContext.js   # ä¸»é¢˜çŠ¶æ€
â”‚   â”œâ”€â”€ lib/                  # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ settlementProcessor.js # ç»“ç®—å•æ•°æ®å¤„ç†
â”‚   â”‚   â”œâ”€â”€ excelHandler.js   # Excel æ–‡ä»¶å¤„ç†
â”‚   â”‚   â”œâ”€â”€ fileValidation.js # æ–‡ä»¶éªŒè¯
â”‚   â”‚   â”œâ”€â”€ logger.js         # æ—¥å¿—å·¥å…·
â”‚   â”‚   â”œâ”€â”€ utils.js          # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ constants.js      # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ data/                 # é™æ€æ•°æ®
â”‚   â”‚   â””â”€â”€ suppliers.js      # ä¾›åº”å•†æ•°æ®
â”‚   â”œâ”€â”€ hooks/                # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â””â”€â”€ use-toast.js      # Toast æç¤º
â”‚   â””â”€â”€ types/                # ç±»å‹å®šä¹‰
â”‚       â””â”€â”€ index.js
â”œâ”€â”€ public/                   # é™æ€èµ„æº
â”œâ”€â”€ package.json
â”œâ”€â”€ tailwind.config.js        # Tailwind é…ç½®
â”œâ”€â”€ next.config.mjs           # Next.js é…ç½®
â”œâ”€â”€ components.json           # shadcn/ui é…ç½®
â”œâ”€â”€ eslint.config.mjs         # ESLint é…ç½®
â”œâ”€â”€ AGENTS.md                 # Agent æŒ‡å—
â”œâ”€â”€ IFLOW.md                  # è¯¦ç»†æ–‡æ¡£
â””â”€â”€ README.md                 # æœ¬æ–‡æ¡£
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### ç»“ç®—å•å¤„ç†æµç¨‹

1. **æ–‡ä»¶ä¸Šä¼ **: æ”¯æŒ .xlsx, .xls, .csv æ ¼å¼ï¼Œ50MB é™åˆ¶
2. **æ•°æ®éªŒè¯**: æ£€æŸ¥å¿…éœ€åˆ—ï¼ˆå•†å“ç¼–å·ã€é‡‘é¢åˆ—ï¼‰
3. **æ•°æ®å¤„ç†**:
   - æŒ‰è´¹ç”¨åç§°è¿‡æ»¤ï¼ˆåªå¤„ç†"è´§æ¬¾"è®°å½•ï¼‰
   - åˆå¹¶ç›¸åŒ SKU çš„è´§æ¬¾å’Œæ•°é‡
   - å¤„ç†ç›´è¥æœåŠ¡è´¹ï¼ˆæŒ‰å•†å“ç¼–å·åˆ†ç»„ï¼‰
   - å¤„ç†å”®åå–å®¶èµ”ä»˜è´¹ï¼ˆç´¯åŠ æ€»é¢ï¼ŒæŒ‰è´§æ¬¾æ¯”ä¾‹åˆ†æ‘Šï¼‰
4. **ç»“æœè®¡ç®—**:
   - è´§æ¬¾ = åº”ç»“é‡‘é¢ - åˆ†æ‘Šçš„èµ”ä»˜è´¹
   - æ”¶å…¥ = è´§æ¬¾ + ç›´è¥æœåŠ¡è´¹
5. **å¯¼å‡ºç»“æœ**: ç”Ÿæˆ Excel æ–‡ä»¶ï¼Œå•†å“ç¼–å·è®¾ç½®ä¸ºæ–‡æœ¬æ ¼å¼

### æ‰‹åŠ¨è°ƒæ•´åŠŸèƒ½

- æ”¯æŒå¤šè¡Œè¾“å…¥ï¼Œæ‰¹é‡å¤„ç†
- ç›¸åŒ SKU è‡ªåŠ¨åˆå¹¶è®¡ç®—
- SKU æœªæ‰¾åˆ°æˆ–æ•°é‡ä¸è¶³æ—¶æ˜¾ç¤ºé”™è¯¯æç¤º
- åªæœ‰æ‰€æœ‰éªŒè¯é€šè¿‡æ‰æäº¤æ•°æ®

### ä¾›åº”å•†è½¬æ¢

- æ ¹æ®åŒ¹é…å­—ç¬¦ä¸²è‡ªåŠ¨è¯†åˆ«æ–‡æœ¬ä¸­çš„ä¾›åº”å•†ä¿¡æ¯
- æ”¯æŒè‡ªå®šä¹‰ä¾›åº”å•†åŒ¹é…è§„åˆ™
- æ‰¹é‡è½¬æ¢ä¾›åº”å•†ä¿¡æ¯

## ğŸ“ å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼

- ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥
- éµå¾ª React 19 æœ€ä½³å®è·µ
- æ‰€æœ‰å®¢æˆ·ç«¯ç»„ä»¶å¿…é¡»ä»¥ `"use client"` å¼€å¤´
- ä½¿ç”¨ shadcn/ui ç»„ä»¶åº“ï¼Œéµå¾ªå…¶è®¾è®¡è§„èŒƒ

### å¯¼å…¥é¡ºåº

```javascript
// 1. React
import React, { useState, useEffect } from "react";

// 2. ç¬¬ä¸‰æ–¹åº“
import Decimal from "decimal.js";
import ExcelJS from "exceljs";

// 3. é¡¹ç›®å†…éƒ¨ï¼ˆä½¿ç”¨ @/ åˆ«åï¼‰
import { useApp } from "@/context/AppContext";
import { Button } from "@/components/ui/button";
import { cn } from "@/lib/utils";

// 4. ç›¸å¯¹è·¯å¾„
import { MyComponent } from "./MyComponent";
```

### é‡‘é¢è®¡ç®—è§„èŒƒ

```javascript
// å§‹ç»ˆä½¿ç”¨ Decimal.js é¿å…æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜
import Decimal from "decimal.js";

function cleanNumber(value) {
  if (typeof value === "string") {
    return parseFloat(value.replace(/[^0-9.-]/g, "")) || 0;
  }
  return value;
}

const amount = new Decimal(cleanNumber(value));
const total = amount.plus(new Decimal(10));
const displayValue = total.toNumber();
```

**é‡è¦**: å•†å“ç¼–å·å¿…é¡»å¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œé˜²æ­¢ Excel è‡ªåŠ¨è½¬æ¢ä¸ºæ•°å­—ï¼š
```javascript
const productCode = String(row["å•†å“ç¼–å·"] || "");
```

### é”™è¯¯å¤„ç†è§„èŒƒ

```javascript
// æ‰€æœ‰å¼‚æ­¥æ“ä½œä½¿ç”¨ try-catch
try {
  const result = await someAsyncOperation();
  // å¤„ç†ç»“æœ
} catch (error) {
  console.error("æ“ä½œå¤±è´¥:", error);
  setError(error.message);
}
```

### Context ä½¿ç”¨è§„èŒƒ

```javascript
// ä½¿ç”¨è‡ªå®šä¹‰ Hook è®¿é—® Context
import { useApp } from "@/context/AppContext";

function MyComponent() {
  const { processedData, setProcessedData, addLog } = useApp();
  // ...
}

// CRITICAL: æ°¸è¿œä¸è¦ç›´æ¥ä¿®æ”¹ stateï¼Œå§‹ç»ˆä½¿ç”¨ Context actions
```

### æ ·å¼è§„èŒƒ

- ä½¿ç”¨ shadcn/ui çš„è¯­ä¹‰åŒ– CSS å˜é‡
- é¿å…ä½¿ç”¨è‡ªå®šä¹‰é¢œè‰²ç±»å
- ä½¿ç”¨ Tailwind çš„å·¥å…·ç±»å’Œ shadcn/ui çš„ç»„ä»¶å˜ä½“

```javascript
// âœ… æ¨è - ä½¿ç”¨ shadcn/ui è¯­ä¹‰åŒ–ç±»å
<div className="bg-card text-foreground border-border" />

// âŒ é¿å… - ä½¿ç”¨è‡ªå®šä¹‰é¢œè‰²
<div className="bg-white text-gray-800 border-gray-200" />
```

### æ–‡ä»¶å¤„ç†è§„èŒƒ

- **CSV ç¼–ç **: å…ˆå°è¯• UTF-8ï¼Œå¤±è´¥åå°è¯• GBK
- **Excel æ•°å­—åˆ—**: å•†å“ç¼–å·è®¾ç½®ä¸ºæ–‡æœ¬æ ¼å¼ (`numFmt: '@'`)
- **Excel å…¬å¼**: å¤„ç† `{ formula: '...', result: ... }` å¯¹è±¡

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

- âœ… æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆ50MBï¼‰
- âœ… æ”¯æŒçš„æ–‡ä»¶ç±»å‹éªŒè¯ï¼ˆ.xlsx, .xls, .csvï¼‰
- âœ… æ–‡ä»¶ç±»å‹ MIME éªŒè¯
- âœ… æ— æ•°æ®åº“ä¾èµ–ï¼Œæ•°æ®ä»…åœ¨å†…å­˜ä¸­å¤„ç†
- âœ… ç”Ÿäº§ç¯å¢ƒå»ºè®®æ·»åŠ èº«ä»½éªŒè¯å’Œæˆæƒ

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### è´¡çŒ®æ­¥éª¤

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ GitHub Issues åé¦ˆã€‚

## ğŸ“¦ ç‰ˆæœ¬ä¿¡æ¯

- **å½“å‰ç‰ˆæœ¬**: 0.1.0
- **Next.js**: 16.0.10
- **React**: 19.2.0
- **Node.js**: 18+
- **Tailwind CSS**: 3.4.18
- **shadcn/ui**: New York style

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **AGENTS.md**: AI Agent å¼€å‘æŒ‡å—
- **IFLOW.md**: è¯¦ç»†æŠ€æœ¯æ–‡æ¡£
- **package.json**: ä¾èµ–å’Œè„šæœ¬é…ç½®

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **å¼€å‘**: è¿è¡Œ `npm run dev` å¼€å§‹å¼€å‘
2. **æµ‹è¯•**: å®‰è£… Vitest + Testing Library æ·»åŠ æµ‹è¯•
3. **éƒ¨ç½²**: è¿è¡Œ `npm run build` æ„å»ºç”Ÿäº§ç‰ˆæœ¬
4. **è‡ªå®šä¹‰**: ä¿®æ”¹ `src/data/suppliers.js` æ·»åŠ ä¾›åº”å•†
